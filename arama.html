<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <title>Arama Sonuçları</title>
</head>
<body>
    <h1>Arama Sonuçları</h1>
    <div id="results"></div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const query = params.get('q')?.toLowerCase();
        const resultsDiv = document.getElementById('results');

        if (!query) {
            resultsDiv.innerText = "Arama kelimesi bulunamadı.";
        } else {
            resultsDiv.innerText = `“${query}” için arama yapılıyor...`;

            const apiLinks = [
                "https://script.google.com/macros/s/AKfycbyhpVQ3QQN7JiNNkvHV7yVbUCAIQCAyaqXbRUJwsnw1LFuI-4ug7U4gXMwOHMjf1qds1g/exec"
            ];

            Promise.all(apiLinks.map(link => fetch(link).then(res => res.json())))
                .then(allDataArrays => {
                    const allData = allDataArrays.flat();

                    const filtered = allData.filter(item => {
                        return (
                            item.name?.toLowerCase().includes(query) ||
                            item.latin_name?.toLowerCase().includes(query) ||
                            item.description?.toLowerCase().includes(query)
                        );
                    });

                    if (filtered.length === 0) {
                        resultsDiv.innerText = "Arama kriterlerinize uygun canlı bulunamadı.";
                    } else {
                        resultsDiv.innerHTML = '';
                        filtered.forEach(canli => {
                            const card = document.createElement('div');
                            card.style.border = '1px solid #ccc';
                            card.style.margin = '10px';
                            card.style.padding = '10px';
                            card.style.borderRadius = '10px';
                            card.style.maxWidth = '400px';

                            card.innerHTML = `
            <h3>${canli.name} <i>(${canli.latin_name})</i></h3>
            <img src="${canli.image}" alt="${canli.name}" style="max-width: 100%; height: auto;" />
            <p>${canli.description}</p>
            <p><strong>Tehlike Derecesi:</strong> ${canli.degree_of_hazard}</p>
          `;

                            resultsDiv.appendChild(card);
                        });
                    }
                })
                .catch(err => {
                    resultsDiv.innerText = "Veriler yüklenirken hata oluştu.";
                    console.error("Hata:", err);
                });
        }



    </script>

</body>
</html>

