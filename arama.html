<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <title>Arama Sonuçları</title>
    <link href="../css/geributonu.css" rel="stylesheet" />
      <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f9f9f9;
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
    }

    #results {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }

    .result-card {
      background-color: #d7c944;
      border: 1px solid #ddd;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
      padding: 20px;
      max-width: 350px;
      width: 100%;
      transition: transform 0.2s ease;
    }

    .result-card:hover {
      transform: scale(1.02);
    }

    .result-card h3 {
      margin-top: 0;
      color: #2a2a2a;
    }

    .result-card img {
      max-width: 100%;
      height: auto;
      border-radius: 10px;
      margin: 10px 0;
    }

    .result-card p {
      color: #555;
      line-height: 1.5;
    }

    .result-card strong {
      color: #444;
    }
  </style>
</head>
<body>
    <a href="/index.html" class="back-button">← Geri</a>

    <h1>Arama Sonuçları</h1>
    <div id="results"></div>

    <div id="loading">
    <div class="spinner"></div>
        Yükleniyor...
    </div>

    <script>

        const params = new URLSearchParams(window.location.search);
        const query = params.get('q')?.toLowerCase();
        const resultsDiv = document.getElementById('results');

        if (!query) {
            resultsDiv.innerText = "Arama kelimesi bulunamadı.";
        } else {
            resultsDiv.innerText = `“${query}” için arama yapılıyor...`;

            const apiLinks = [
                "https://script.google.com/macros/s/AKfycbwQHy9Q8f2mRHzMvNhz32AkqINSi2NNxcPARuc3xXVrqnDxmfHKClFrp-lvNOlS7Revuw/exec"
            ];

            Promise.all(apiLinks.map(link => fetch(link).then(res => res.json())))
                .then(allDataArrays => {
                    const allData = allDataArrays.flat();

                    const filtered = allData.filter(item => {
                        return (
                            item.name?.toLowerCase().includes(query) ||
                            item.latin_name?.toLowerCase().includes(query) ||
                            item.description?.toLowerCase().includes(query)
                        );
                    });

                    if (filtered.length === 0) {
                        resultsDiv.innerText = "Arama kriterlerinize uygun canlı bulunamadı.";
                    } else {
                        resultsDiv.innerHTML = '';
                        filtered.forEach(canli => {
                            const card = document.createElement('div');
                            card.style.border = '1px solid #ccc';
                            card.style.margin = '10px';
                            card.style.padding = '10px';
                            card.style.borderRadius = '10px';
                            card.style.maxWidth = '400px';

                            card.innerHTML = `
            <h3>${canli.name} <i>(${canli.latin_name})</i></h3>
            <img src="${canli.image}" alt="${canli.name}" style="max-width: 100%; height: auto;" />
            <p>${canli.description}</p>
            <p><strong>Tehlike Derecesi:</strong> ${canli.degree_of_hazard}</p>
          `;

                            resultsDiv.appendChild(card);
                        });
                    }
                })
                .catch(err => {
                    resultsDiv.innerText = "Veriler yüklenirken hata oluştu.";
                    console.error("Hata:", err);
                });
        }

    </script>

</body>
</html>

